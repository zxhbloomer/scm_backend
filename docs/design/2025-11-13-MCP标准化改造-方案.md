# MCP æ ‡å‡†åŒ–æ”¹é€ æ–¹æ¡ˆ

## æ–‡æ¡£ä¿¡æ¯
- **åˆ›å»ºæ—¥æœŸ**: 2025-11-13
- **æ–‡æ¡£ç±»å‹**: æŠ€æœ¯è®¾è®¡æ–¹æ¡ˆ
- **æ¶‰åŠæ¨¡å—**: scm-ai (MCPå·¥å…·æœåŠ¡)
- **å½±å“èŒƒå›´**: P00000025ä»“åº“ç®¡ç†MCPå·¥å…·é›†

## ä¸€ã€èƒŒæ™¯å’Œé—®é¢˜æè¿°

### 1.1 é¡¹ç›®èƒŒæ™¯
å½“å‰ç³»ç»Ÿåœ¨ `scm-ai` æ¨¡å—ä¸­å®ç°äº†ä¸€å¥— MCP (Model Context Protocol) å·¥å…·ï¼Œç”¨äºä¸º AI æä¾›ä»“åº“ç®¡ç†èƒ½åŠ›ï¼ŒåŒ…æ‹¬ï¼š
- **BinMcpTools**: åº“ä½ç®¡ç†å·¥å…·ï¼ˆæŸ¥è¯¢ã€åˆ›å»ºã€æ›´æ–°åº“ä½ä¿¡æ¯ï¼‰
- **LocationMcpTools**: åº“åŒºç®¡ç†å·¥å…·ï¼ˆæŸ¥è¯¢ã€åˆ›å»ºã€æ›´æ–°åº“åŒºä¿¡æ¯ï¼‰
- **WarehouseMcpTools**: ä»“åº“ç®¡ç†å·¥å…·ï¼ˆæŸ¥è¯¢ã€åˆ›å»ºã€æ›´æ–°ä»“åº“ä¿¡æ¯ï¼‰

### 1.2 æ ¸å¿ƒé—®é¢˜
é€šè¿‡å¯¹ Spring AI å®˜æ–¹æ–‡æ¡£å’Œç°æœ‰ä»£ç çš„å¯¹æ¯”åˆ†æï¼Œå‘ç°å½“å‰å®ç°å­˜åœ¨ä»¥ä¸‹**å…³é”®æ€§é—®é¢˜**ï¼š

#### âŒ é—®é¢˜1ï¼šä½¿ç”¨äº†é”™è¯¯çš„æ³¨è§£ä½“ç³»
```java
// âŒ å½“å‰å®ç°ï¼ˆé”™è¯¯ï¼‰
import org.springframework.ai.tool.annotation.Tool;
import org.springframework.ai.tool.annotation.ToolParam;

@Tool(description = "æŸ¥è¯¢åº“ä½ä¿¡æ¯...")
public String queryBins(@ToolParam(description = "ç§Ÿæˆ·ID") String tenantId) {
    // ...
}
```

**é—®é¢˜åˆ†æ**ï¼š
- `@Tool` å’Œ `@ToolParam` æ˜¯ **Spring AI Function Calling** çš„æ³¨è§£
- Function Calling æ˜¯ Spring AI çš„å†…éƒ¨å·¥å…·è°ƒç”¨æœºåˆ¶
- **ä¸ç¬¦åˆ MCP (Model Context Protocol) æ ‡å‡†**

#### âœ… æ­£ç¡®å®ç°åº”è¯¥æ˜¯
```java
// âœ… æ­£ç¡®å®ç°ï¼ˆMCPæ ‡å‡†ï¼‰
import org.springframework.ai.tool.annotation.McpTool;
import org.springframework.ai.tool.annotation.McpToolParam;

@McpTool(
    name = "query_bins",  // å¿…é¡»ï¼šå·¥å…·åç§°ï¼ˆsnake_caseï¼‰
    description = "æŸ¥è¯¢åº“ä½ä¿¡æ¯..."
)
public String queryBins(
    @McpToolParam(description = "ç§Ÿæˆ·ID", required = true) String tenantId) {
    // ...
}
```

#### âŒ é—®é¢˜2ï¼šç¼ºå°‘ MCP Server ä¾èµ–
å½“å‰ `pom.xml` ä¸­**æ²¡æœ‰æ·»åŠ ** MCP Server çš„æ ¸å¿ƒä¾èµ–ï¼š
```xml
<!-- âŒ å½“å‰ç¼ºå¤± -->
<dependency>
    <groupId>org.springframework.ai</groupId>
    <artifactId>spring-ai-starter-mcp-server-webmvc</artifactId>
</dependency>
```

**å½±å“**ï¼š
- MCP æ³¨è§£æ— æ³•è¢«è¯†åˆ«
- MCP Server æ¡†æ¶ä¸å¯ç”¨
- æ— æ³•æä¾›æ ‡å‡† MCP åè®®ç«¯ç‚¹

#### âŒ é—®é¢˜3ï¼šç¼ºå°‘ MCP Server é…ç½®
å½“å‰ `application.yml` ä¸­**æ²¡æœ‰** MCP Server çš„é…ç½®ï¼š
```yaml
# âŒ å½“å‰ç¼ºå¤±
spring:
  ai:
    mcp:
      server:
        enabled: true
        name: "scm-warehouse-mcp-server"
        # ... å…¶ä»–é…ç½®
```

**å½±å“**ï¼š
- MCP Server ä¸ä¼šå¯åŠ¨
- æ— æ³•æä¾›å·¥å…·å‘ç°ç«¯ç‚¹
- Claude Desktopã€Cursor ç­‰ MCP å®¢æˆ·ç«¯æ— æ³•è¿æ¥

#### âŒ é—®é¢˜4ï¼šæ³¨è§£å‚æ•°ä¸å®Œæ•´
å½“å‰å®ç°ä¸­ï¼š
- `@Tool` ç¼ºå°‘ `name` å‚æ•°ï¼ˆå·¥å…·å”¯ä¸€æ ‡è¯†ï¼‰
- `@ToolParam` ç¼ºå°‘ `required` å‚æ•°ï¼ˆå‚æ•°å¿…å¡«æ ¡éªŒï¼‰

**å½±å“**ï¼š
- å·¥å…·å…ƒæ•°æ®ä¸è§„èŒƒ
- ç¼ºå°‘å‚æ•°æ ¡éªŒ
- MCP å®¢æˆ·ç«¯æ— æ³•æ­£ç¡®è¯†åˆ«å·¥å…· schema

### 1.3 å½±å“èŒƒå›´

| å½±å“ç»´åº¦ | å…·ä½“å½±å“ |
|---------|---------|
| **æ ‡å‡†å…¼å®¹æ€§** | âŒ ä¸ç¬¦åˆ Anthropic MCP æ ‡å‡†ï¼Œæ— æ³•è¢« MCP å®¢æˆ·ç«¯è¯†åˆ« |
| **å·¥å…·å‘ç°** | âŒ æ— æ³•é€šè¿‡ MCP åè®®è‡ªåŠ¨å‘ç°å·¥å…·åˆ—è¡¨ |
| **å®¢æˆ·ç«¯é›†æˆ** | âŒ Claude Desktopã€Cursor ç­‰å·¥å…·æ— æ³•è¿æ¥ |
| **å¯ç»´æŠ¤æ€§** | âŒ æ··ç”¨ Function Calling å’Œ MCP æ¦‚å¿µï¼Œç»´æŠ¤å›°éš¾ |
| **æ‰©å±•æ€§** | âŒ æ— æ³•åˆ©ç”¨ MCP ç”Ÿæ€ç³»ç»Ÿï¼ˆpromptsã€resourcesï¼‰ |

## äºŒã€å½“å‰å®ç°è¯¦ç»†åˆ†æ

### 2.1 ç°æœ‰ä»£ç ç»“æ„
```
scm-ai/src/main/java/com/xinyirun/scm/ai/mcp/P00000025/
â”œâ”€â”€ tools/
â”‚   â”œâ”€â”€ BinMcpTools.java          # åº“ä½ç®¡ç†å·¥å…·ï¼ˆ348è¡Œï¼‰
â”‚   â”œâ”€â”€ LocationMcpTools.java     # åº“åŒºç®¡ç†å·¥å…·
â”‚   â””â”€â”€ WarehouseMcpTools.java    # ä»“åº“ç®¡ç†å·¥å…·
â””â”€â”€ service/
    â”œâ”€â”€ BinAiService.java         # åº“ä½ä¸šåŠ¡æœåŠ¡
    â”œâ”€â”€ LocationAiService.java    # åº“åŒºä¸šåŠ¡æœåŠ¡
    â””â”€â”€ WarehouseAiService.java   # ä»“åº“ä¸šåŠ¡æœåŠ¡
```

### 2.2 BinMcpTools ç°çŠ¶åˆ†æ

#### å½“å‰å®ç°ï¼ˆéƒ¨åˆ†ä»£ç ï¼‰
```java
package com.xinyirun.scm.ai.mcp.P00000025.tools;

import org.springframework.ai.tool.annotation.Tool;  // âŒ é”™è¯¯æ³¨è§£
import org.springframework.ai.tool.annotation.ToolParam;  // âŒ é”™è¯¯æ³¨è§£
import org.springframework.stereotype.Component;

@Slf4j
@Component
public class BinMcpTools {

    @Autowired
    private BinAiService binAiService;

    // âŒ é—®é¢˜ç¤ºä¾‹1ï¼šåº“ä½æŸ¥è¯¢å·¥å…·
    @Tool(description = "æŸ¥è¯¢åº“ä½ä¿¡æ¯ï¼Œæ”¯æŒæŒ‰ä»“åº“ã€åº“åŒºã€ç¼–ç ã€çŠ¶æ€ç­‰æ¡ä»¶æŸ¥è¯¢åº“ä½åˆ—è¡¨")
    public String queryBins(
        @ToolParam(description = "ç§Ÿæˆ·ID") String tenantId,  // âŒ ç¼ºå°‘ required å‚æ•°
        @ToolParam(description = "ä»“åº“ID") Integer warehouseId,
        @ToolParam(description = "åº“åŒºID") Integer locationId,
        // ... æ›´å¤šå‚æ•°
    ) {
        // ä¸šåŠ¡é€»è¾‘å®ç°...
    }

    // âŒ é—®é¢˜ç¤ºä¾‹2ï¼šåº“ä½åˆ›å»ºå·¥å…·
    @Tool(description = "åˆ›å»ºæ–°çš„åº“ä½")
    public String createBin(
        @ToolParam(description = "ç§Ÿæˆ·ID") String tenantId,
        @ToolParam(description = "åº“ä½ç¼–ç ") String code,
        // ... æ›´å¤šå‚æ•°
    ) {
        // ä¸šåŠ¡é€»è¾‘å®ç°...
    }

    // ... å…¶ä»–å·¥å…·æ–¹æ³•
}
```

**é—®é¢˜ç»Ÿè®¡**ï¼š
- âŒ ä½¿ç”¨ `@Tool` è€Œé `@McpTool`ï¼š**100%** çš„å·¥å…·æ–¹æ³•
- âŒ ç¼ºå°‘ `name` å‚æ•°ï¼š**100%** çš„å·¥å…·æ–¹æ³•
- âŒ ç¼ºå°‘ `required` å‚æ•°ï¼š**100%** çš„å‚æ•°å®šä¹‰

### 2.3 LocationMcpTools å’Œ WarehouseMcpTools
**é¢„æœŸé—®é¢˜**ï¼šä¸ BinMcpTools ç›¸åŒçš„æ³¨è§£ä½¿ç”¨é—®é¢˜

## ä¸‰ã€MCP æ ‡å‡†ä¸ Function Calling å¯¹æ¯”

### 3.1 æ ¸å¿ƒå·®å¼‚

| ç»´åº¦ | Function Calling | MCP Protocol |
|------|------------------|--------------|
| **åè®®æ ‡å‡†** | Spring AI å†…éƒ¨æœºåˆ¶ | Anthropic è¡Œä¸šæ ‡å‡† |
| **æ³¨è§£** | `@Tool`, `@ToolParam` | `@McpTool`, `@McpToolParam` |
| **å·¥å…·å‘ç°** | æ— æ ‡å‡†ç«¯ç‚¹ | `/mcp/tools/list` |
| **å®¢æˆ·ç«¯** | Spring AI ChatClient | Claude Desktop, Cursor, VS Code |
| **ç”Ÿæ€** | Spring ç”Ÿæ€ | è·¨å¹³å° MCP ç”Ÿæ€ |
| **é€‚ç”¨åœºæ™¯** | Spring AI åº”ç”¨å†…éƒ¨ | è·¨åº”ç”¨ã€è·¨å¹³å°å·¥å…·å…±äº« |

### 3.2 MCP åè®®ä¼˜åŠ¿

1. **è¡Œä¸šæ ‡å‡†**ï¼šAnthropic æ¨å‡ºçš„è¡Œä¸šæ ‡å‡†åè®®
2. **è·¨å¹³å°**ï¼šä»»ä½• MCP å®¢æˆ·ç«¯éƒ½å¯ä»¥å‘ç°å’Œä½¿ç”¨å·¥å…·
3. **å·¥å…·å‘ç°**ï¼šæ ‡å‡†åŒ–çš„å·¥å…·å‘ç°ç«¯ç‚¹ï¼ˆ`/mcp/tools/list`ï¼‰
4. **ä¸°å¯Œç”Ÿæ€**ï¼šæ”¯æŒ Toolsã€Resourcesã€Prompts ä¸‰å¤§èƒ½åŠ›
5. **æœªæ¥å…¼å®¹**ï¼šä¸ Anthropic ç”Ÿæ€ç³»ç»Ÿæ·±åº¦é›†æˆ

### 3.3 ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ MCP

**å½“å‰éœ€æ±‚**ï¼š
- âœ… éœ€è¦æš´éœ²ä»“åº“ç®¡ç†å·¥å…·ç»™ **å¤–éƒ¨ AI å®¢æˆ·ç«¯**
- âœ… éœ€è¦æ”¯æŒ **Claude Desktop** ç­‰ MCP å®¢æˆ·ç«¯è¿æ¥
- âœ… éœ€è¦æ ‡å‡†åŒ–çš„**å·¥å…·å‘ç°æœºåˆ¶**
- âœ… éœ€è¦ç¬¦åˆ**è¡Œä¸šæ ‡å‡†**ï¼Œä¾¿äºæœªæ¥æ‰©å±•

**ç»“è®º**ï¼šå½“å‰åœºæ™¯åº”è¯¥ä½¿ç”¨ **MCP æ ‡å‡†**ï¼Œè€Œé Function Calling

## å››ã€è§£å†³æ–¹æ¡ˆè®¾è®¡

### 4.1 æ€»ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   MCP å®¢æˆ·ç«¯å±‚                          â”‚
â”‚  Claude Desktop / Cursor / VS Code / å…¶ä»–MCPå®¢æˆ·ç«¯      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ MCP Protocol (STREAMABLE)
                     â”‚ HTTP/SSE Transport
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Spring AI MCP Server                       â”‚
â”‚  - å·¥å…·å‘ç°ç«¯ç‚¹: /mcp/tools/list                       â”‚
â”‚  - å·¥å…·è°ƒç”¨ç«¯ç‚¹: /mcp/tools/call/{toolName}            â”‚
â”‚  - SSE æ¶ˆæ¯ç«¯ç‚¹: /api/mcp/message                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              MCP å·¥å…·å±‚ï¼ˆ@McpToolï¼‰                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ BinMcpTools      â”‚ LocationMcpTools â”‚ Warehouse...â”‚ â”‚
â”‚  â”‚ - query_bins     â”‚ - query_location â”‚ - query_... â”‚ â”‚
â”‚  â”‚ - create_bin     â”‚ - create_loc     â”‚ - create... â”‚ â”‚
â”‚  â”‚ - update_bin     â”‚ - update_loc     â”‚ - update... â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                  â”‚                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ä¸šåŠ¡æœåŠ¡å±‚ï¼ˆServiceï¼‰                      â”‚
â”‚  - BinAiService                                         â”‚
â”‚  - LocationAiService                                    â”‚
â”‚  - WarehouseAiService                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              æ•°æ®è®¿é—®å±‚ï¼ˆMapperï¼‰                       â”‚
â”‚  - BinMapper / LocationMapper / WarehouseMapper         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 æ ¸å¿ƒæ”¹é€ ç‚¹

#### 4.2.1 ä¾èµ–æ·»åŠ ï¼ˆpom.xmlï¼‰

```xml
<!-- MCP Server æ ¸å¿ƒä¾èµ– -->
<dependency>
    <groupId>org.springframework.ai</groupId>
    <artifactId>spring-ai-starter-mcp-server-webmvc</artifactId>
</dependency>
```

**è¯´æ˜**ï¼š
- é€‰æ‹© `webmvc` ç‰ˆæœ¬ï¼ˆé€‚é…ç°æœ‰ Spring MVC æ¶æ„ï¼‰
- å¦‚æœä½¿ç”¨ WebFluxï¼Œåˆ™é€‰æ‹© `spring-ai-starter-mcp-server-webflux`

#### 4.2.2 é…ç½®æ·»åŠ ï¼ˆapplication.ymlï¼‰

```yaml
spring:
  ai:
    mcp:
      server:
        # åŸºç¡€é…ç½®
        enabled: true
        name: "scm-warehouse-mcp-server"
        version: "1.0.0"
        description: "SCM ä»“åº“ç®¡ç† MCP æœåŠ¡å™¨ - æä¾›åº“ä½ã€åº“åŒºã€ä»“åº“ç®¡ç†å·¥å…·"

        # æœåŠ¡å™¨ç±»å‹å’Œåè®®
        type: SYNC                    # åŒæ­¥è°ƒç”¨æ¨¡å¼
        protocol: STREAMABLE          # æ”¯æŒæµå¼ä¼ è¾“
        transport: WEBMVC             # WebMVC ä¼ è¾“å±‚

        # ç«¯ç‚¹é…ç½®
        sse-message-endpoint: /api/mcp/message  # SSE æ¶ˆæ¯ç«¯ç‚¹

        # èƒ½åŠ›é…ç½®
        capabilities:
          tool: true                  # å¯ç”¨å·¥å…·èƒ½åŠ›ï¼ˆæ ¸å¿ƒï¼‰
          resource: true              # å¯ç”¨èµ„æºèƒ½åŠ›ï¼ˆæœªæ¥æ‰©å±•ï¼‰
          prompt: true                # å¯ç”¨æç¤ºèƒ½åŠ›ï¼ˆæœªæ¥æ‰©å±•ï¼‰
          completion: true            # å¯ç”¨è¡¥å…¨èƒ½åŠ›ï¼ˆæœªæ¥æ‰©å±•ï¼‰

        # å·¥å…·é…ç½®
        tools:
          enabled: true
          auto-register: true         # è‡ªåŠ¨æ³¨å†Œ @McpTool æ³¨è§£çš„å·¥å…·

        # æ—¥å¿—é…ç½®
        logging:
          enabled: true
          level: INFO
```

**é…ç½®è¯´æ˜**ï¼š

| é…ç½®é¡¹ | è¯´æ˜ | é€‰æ‹©ç†ç”± |
|--------|------|---------|
| `type: SYNC` | åŒæ­¥è°ƒç”¨æ¨¡å¼ | ä»“åº“ç®¡ç†æ“ä½œä¸ºåŒæ­¥ä¸šåŠ¡ |
| `protocol: STREAMABLE` | æµå¼åè®® | æ”¯æŒå®æ—¶é€šçŸ¥å’Œè¿›åº¦åé¦ˆ |
| `transport: WEBMVC` | WebMVC ä¼ è¾“ | é€‚é…ç°æœ‰ Spring MVC æ¶æ„ |
| `tool: true` | å¯ç”¨å·¥å…·èƒ½åŠ› | æ ¸å¿ƒåŠŸèƒ½éœ€æ±‚ |
| `auto-register: true` | è‡ªåŠ¨æ³¨å†Œå·¥å…· | å‡å°‘æ‰‹åŠ¨é…ç½® |

#### 4.2.3 æ³¨è§£æ”¹é€ æ ‡å‡†

##### BinMcpTools æ”¹é€ ç¤ºä¾‹

**æ”¹é€ å‰**ï¼š
```java
@Tool(description = "æŸ¥è¯¢åº“ä½ä¿¡æ¯ï¼Œæ”¯æŒæŒ‰ä»“åº“ã€åº“åŒºã€ç¼–ç ã€çŠ¶æ€ç­‰æ¡ä»¶æŸ¥è¯¢åº“ä½åˆ—è¡¨")
public String queryBins(
    @ToolParam(description = "ç§Ÿæˆ·IDï¼Œç”¨äºæ•°æ®æƒé™æ§åˆ¶") String tenantId,
    @ToolParam(description = "ä»“åº“IDï¼Œç”¨äºæŸ¥è¯¢æŒ‡å®šä»“åº“çš„åº“ä½") Integer warehouseId,
    @ToolParam(description = "åº“åŒºIDï¼Œç”¨äºæŸ¥è¯¢æŒ‡å®šåº“åŒºçš„åº“ä½") Integer locationId,
    @ToolParam(description = "åº“ä½ç¼–ç ï¼Œæ”¯æŒæ¨¡ç³ŠæŸ¥è¯¢") String code,
    @ToolParam(description = "åº“ä½çŠ¶æ€: 0-ç¦ç”¨, 1-å¯ç”¨, 2-ç»´æŠ¤ä¸­") Integer status
) {
    // ...
}
```

**æ”¹é€ å**ï¼š
```java
@McpTool(
    name = "query_bins",  // ğŸ”¥ æ–°å¢ï¼šå·¥å…·å”¯ä¸€æ ‡è¯†ï¼ˆsnake_caseï¼‰
    description = "æŸ¥è¯¢åº“ä½ä¿¡æ¯ï¼Œæ”¯æŒæŒ‰ä»“åº“ã€åº“åŒºã€ç¼–ç ã€çŠ¶æ€ç­‰æ¡ä»¶æŸ¥è¯¢åº“ä½åˆ—è¡¨ï¼Œç”¨äºåº“ä½ä¿¡æ¯çš„æŸ¥æ‰¾å’Œæµè§ˆ"
)
public String queryBins(
    @McpToolParam(
        description = "ç§Ÿæˆ·IDï¼Œç”¨äºæ•°æ®æƒé™æ§åˆ¶",
        required = true  // ğŸ”¥ æ–°å¢ï¼šå¿…å¡«æ ¡éªŒ
    ) String tenantId,

    @McpToolParam(
        description = "ä»“åº“IDï¼Œç”¨äºæŸ¥è¯¢æŒ‡å®šä»“åº“çš„åº“ä½",
        required = false  // ğŸ”¥ æ–°å¢ï¼šå¯é€‰å‚æ•°
    ) Integer warehouseId,

    @McpToolParam(
        description = "åº“åŒºIDï¼Œç”¨äºæŸ¥è¯¢æŒ‡å®šåº“åŒºçš„åº“ä½",
        required = false
    ) Integer locationId,

    @McpToolParam(
        description = "åº“ä½ç¼–ç ï¼Œæ”¯æŒæ¨¡ç³ŠæŸ¥è¯¢",
        required = false
    ) String code,

    @McpToolParam(
        description = "åº“ä½çŠ¶æ€: 0-ç¦ç”¨, 1-å¯ç”¨, 2-ç»´æŠ¤ä¸­",
        required = false
    ) Integer status
) {
    // ä¸šåŠ¡é€»è¾‘ä¿æŒä¸å˜
    return binAiService.queryBins(tenantId, warehouseId, locationId, code, status);
}
```

##### å·¥å…·å‘½åè§„èŒƒ

| å·¥å…·ç±»å‹ | å‘½åæ ¼å¼ | ç¤ºä¾‹ |
|---------|---------|------|
| æŸ¥è¯¢ç±» | `query_{resource}` | `query_bins`, `query_locations` |
| åˆ›å»ºç±» | `create_{resource}` | `create_bin`, `create_location` |
| æ›´æ–°ç±» | `update_{resource}` | `update_bin`, `update_location` |
| åˆ é™¤ç±» | `delete_{resource}` | `delete_bin`, `delete_location` |
| æ‰¹é‡æŸ¥è¯¢ | `list_{resources}` | `list_bins`, `list_locations` |

**å‘½ååŸåˆ™**ï¼š
- âœ… ä½¿ç”¨ **snake_case** æ ¼å¼
- âœ… åŠ¨è¯åœ¨å‰ï¼Œåè¯åœ¨å
- âœ… åè¯ä½¿ç”¨å¤æ•°å½¢å¼ï¼ˆæŸ¥è¯¢ç±»ï¼‰æˆ–å•æ•°å½¢å¼ï¼ˆæ“ä½œç±»ï¼‰
- âœ… ä¿æŒç®€æ´æ¸…æ™°

#### 4.2.4 å®Œæ•´æ”¹é€ å¯¹æ¯”

##### BinMcpTools.java

| æ”¹é€ é¡¹ | æ”¹é€ å‰ | æ”¹é€ å |
|--------|--------|--------|
| **å¯¼å…¥åŒ…** | `@Tool`, `@ToolParam` | `@McpTool`, `@McpToolParam` |
| **å·¥å…·åç§°** | æ—  | `name = "query_bins"` |
| **å‚æ•°å¿…å¡«** | æ—  | `required = true/false` |
| **å·¥å…·æ€»æ•°** | ~10 ä¸ªæ–¹æ³• | ~10 ä¸ªæ–¹æ³•ï¼ˆä¿æŒä¸å˜ï¼‰ |

**å®Œæ•´å·¥å…·åˆ—è¡¨**ï¼š
1. `query_bins` - æŸ¥è¯¢åº“ä½åˆ—è¡¨
2. `create_bin` - åˆ›å»ºåº“ä½
3. `update_bin` - æ›´æ–°åº“ä½
4. `delete_bin` - åˆ é™¤åº“ä½
5. `enable_bin` - å¯ç”¨åº“ä½
6. `disable_bin` - ç¦ç”¨åº“ä½
7. ï¼ˆå…¶ä»–æ ¹æ®ç°æœ‰æ–¹æ³•è¡¥å……ï¼‰

##### LocationMcpTools.java

**é¢„æœŸæ”¹é€ **ï¼ˆä¸ BinMcpTools ç±»ä¼¼ï¼‰ï¼š
1. `query_locations` - æŸ¥è¯¢åº“åŒºåˆ—è¡¨
2. `create_location` - åˆ›å»ºåº“åŒº
3. `update_location` - æ›´æ–°åº“åŒº
4. `delete_location` - åˆ é™¤åº“åŒº
5. ï¼ˆå…¶ä»–ï¼‰

##### WarehouseMcpTools.java

**é¢„æœŸæ”¹é€ **ï¼ˆä¸ BinMcpTools ç±»ä¼¼ï¼‰ï¼š
1. `query_warehouses` - æŸ¥è¯¢ä»“åº“åˆ—è¡¨
2. `create_warehouse` - åˆ›å»ºä»“åº“
3. `update_warehouse` - æ›´æ–°ä»“åº“
4. `delete_warehouse` - åˆ é™¤ä»“åº“
5. ï¼ˆå…¶ä»–ï¼‰

### 4.3 MCP Server ç«¯ç‚¹è®¾è®¡

æ”¹é€ å®Œæˆåï¼Œç³»ç»Ÿå°†è‡ªåŠ¨æä¾›ä»¥ä¸‹ MCP æ ‡å‡†ç«¯ç‚¹ï¼š

| ç«¯ç‚¹ | æ–¹æ³• | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|
| `/mcp/tools/list` | GET | è·å–æ‰€æœ‰å¯ç”¨å·¥å…·åˆ—è¡¨ | è¿”å›å·¥å…· schema |
| `/mcp/tools/call/{toolName}` | POST | è°ƒç”¨æŒ‡å®šå·¥å…· | è°ƒç”¨ `query_bins` |
| `/api/mcp/message` | GET | SSE æ¶ˆæ¯æ¨é€ | å®æ—¶é€šçŸ¥ |

#### å·¥å…·åˆ—è¡¨å“åº”ç¤ºä¾‹

```json
{
  "tools": [
    {
      "name": "query_bins",
      "description": "æŸ¥è¯¢åº“ä½ä¿¡æ¯ï¼Œæ”¯æŒæŒ‰ä»“åº“ã€åº“åŒºã€ç¼–ç ã€çŠ¶æ€ç­‰æ¡ä»¶æŸ¥è¯¢åº“ä½åˆ—è¡¨",
      "inputSchema": {
        "type": "object",
        "properties": {
          "tenantId": {
            "type": "string",
            "description": "ç§Ÿæˆ·IDï¼Œç”¨äºæ•°æ®æƒé™æ§åˆ¶"
          },
          "warehouseId": {
            "type": "integer",
            "description": "ä»“åº“IDï¼Œç”¨äºæŸ¥è¯¢æŒ‡å®šä»“åº“çš„åº“ä½"
          },
          "locationId": {
            "type": "integer",
            "description": "åº“åŒºIDï¼Œç”¨äºæŸ¥è¯¢æŒ‡å®šåº“åŒºçš„åº“ä½"
          },
          "code": {
            "type": "string",
            "description": "åº“ä½ç¼–ç ï¼Œæ”¯æŒæ¨¡ç³ŠæŸ¥è¯¢"
          },
          "status": {
            "type": "integer",
            "description": "åº“ä½çŠ¶æ€: 0-ç¦ç”¨, 1-å¯ç”¨, 2-ç»´æŠ¤ä¸­"
          }
        },
        "required": ["tenantId"]
      }
    },
    // ... å…¶ä»–å·¥å…·
  ]
}
```

## äº”ã€å®æ–½æ­¥éª¤

### 5.1 é˜¶æ®µåˆ’åˆ†

| é˜¶æ®µ | ä»»åŠ¡ | é¢„è®¡å·¥ä½œé‡ | é£é™©ç­‰çº§ |
|------|------|-----------|---------|
| **é˜¶æ®µ1** | ä¾èµ–å’Œé…ç½® | 0.5h | ä½ |
| **é˜¶æ®µ2** | ä»£ç æ”¹é€  | 2h | ä¸­ |
| **é˜¶æ®µ3** | æµ‹è¯•éªŒè¯ | 1h | ä¸­ |
| **é˜¶æ®µ4** | æ–‡æ¡£æ›´æ–° | 0.5h | ä½ |
| **æ€»è®¡** | - | **4h** | - |

### 5.2 è¯¦ç»†æ­¥éª¤

#### é˜¶æ®µ1ï¼šä¾èµ–å’Œé…ç½®ï¼ˆ0.5hï¼‰

**æ­¥éª¤1.1ï¼šæ·»åŠ  Maven ä¾èµ–**
```bash
# ç¼–è¾‘æ–‡ä»¶
vi scm-ai/pom.xml

# åœ¨ <dependencies> ä¸­æ·»åŠ 
<dependency>
    <groupId>org.springframework.ai</groupId>
    <artifactId>spring-ai-starter-mcp-server-webmvc</artifactId>
</dependency>

# åˆ·æ–° Maven
mvn clean install
```

**æ­¥éª¤1.2ï¼šæ·»åŠ  MCP Server é…ç½®**
```bash
# ç¼–è¾‘é…ç½®æ–‡ä»¶
vi scm-start/src/main/resources/application.yml

# æ·»åŠ  MCP é…ç½®ï¼ˆè§ 4.2.2 èŠ‚ï¼‰
```

**éªŒæ”¶æ ‡å‡†**ï¼š
- âœ… Maven ä¾èµ–ä¸‹è½½æˆåŠŸ
- âœ… åº”ç”¨å¯åŠ¨æ—¶æ—¥å¿—æ˜¾ç¤º MCP Server åˆå§‹åŒ–æˆåŠŸ
- âœ… è®¿é—® `/mcp/tools/list` è¿”å›ç©ºåˆ—è¡¨ï¼ˆå·¥å…·æœªæ³¨å†Œï¼‰

#### é˜¶æ®µ2ï¼šä»£ç æ”¹é€ ï¼ˆ2hï¼‰

**æ­¥éª¤2.1ï¼šæ”¹é€  BinMcpTools.javaï¼ˆ1hï¼‰**
```bash
# ç¼–è¾‘æ–‡ä»¶
vi scm-ai/src/main/java/com/xinyirun/scm/ai/mcp/P00000025/tools/BinMcpTools.java

# æ”¹é€ å†…å®¹ï¼š
# 1. ä¿®æ”¹å¯¼å…¥ï¼šTool â†’ McpTool, ToolParam â†’ McpToolParam
# 2. ä¸ºæ¯ä¸ªå·¥å…·æ–¹æ³•æ·»åŠ  name å‚æ•°
# 3. ä¸ºæ¯ä¸ªå‚æ•°æ·»åŠ  required å‚æ•°
```

**æ”¹é€ æ£€æŸ¥æ¸…å•**ï¼š
- [ ] å¯¼å…¥è¯­å¥å·²æ›´æ–°
- [ ] æ‰€æœ‰ `@Tool` å·²æ›¿æ¢ä¸º `@McpTool`
- [ ] æ‰€æœ‰å·¥å…·æ–¹æ³•æ·»åŠ äº† `name` å‚æ•°
- [ ] æ‰€æœ‰ `@ToolParam` å·²æ›¿æ¢ä¸º `@McpToolParam`
- [ ] æ‰€æœ‰å‚æ•°æ·»åŠ äº† `required` å‚æ•°
- [ ] å·¥å…·åç§°ç¬¦åˆ snake_case è§„èŒƒ

**æ­¥éª¤2.2ï¼šæ”¹é€  LocationMcpTools.javaï¼ˆ0.5hï¼‰**
```bash
# åŒ BinMcpTools çš„æ”¹é€ æµç¨‹
vi scm-ai/src/main/java/com/xinyirun/scm/ai/mcp/P00000025/tools/LocationMcpTools.java
```

**æ­¥éª¤2.3ï¼šæ”¹é€  WarehouseMcpTools.javaï¼ˆ0.5hï¼‰**
```bash
# åŒ BinMcpTools çš„æ”¹é€ æµç¨‹
vi scm-ai/src/main/java/com/xinyirun/scm/ai/mcp/P00000025/tools/WarehouseMcpTools.java
```

**éªŒæ”¶æ ‡å‡†**ï¼š
- âœ… æ‰€æœ‰å·¥å…·ç±»ç¼–è¯‘é€šè¿‡
- âœ… æ— è­¦å‘Šå’Œé”™è¯¯
- âœ… ä»£ç æ ¼å¼è§„èŒƒ

#### é˜¶æ®µ3ï¼šæµ‹è¯•éªŒè¯ï¼ˆ1hï¼‰

**æ­¥éª¤3.1ï¼šå¯åŠ¨åº”ç”¨**
```bash
cd scm-start
mvn spring-boot:run

# è§‚å¯Ÿå¯åŠ¨æ—¥å¿—ï¼Œç¡®è®¤ MCP Server å¯åŠ¨æˆåŠŸ
```

**æ­¥éª¤3.2ï¼šå·¥å…·å‘ç°æµ‹è¯•**
```bash
# æµ‹è¯•å·¥å…·åˆ—è¡¨ç«¯ç‚¹
curl -X GET http://localhost:8088/scm/mcp/tools/list

# é¢„æœŸå“åº”ï¼šåŒ…å«æ‰€æœ‰æ³¨å†Œçš„å·¥å…·
# æ£€æŸ¥ç‚¹ï¼š
# - tools æ•°ç»„ä¸ä¸ºç©º
# - æ¯ä¸ªå·¥å…·åŒ…å« name, description, inputSchema
# - inputSchema åŒ…å« required å­—æ®µ
```

**æ­¥éª¤3.3ï¼šå·¥å…·è°ƒç”¨æµ‹è¯•**
```bash
# æµ‹è¯• query_bins å·¥å…·
curl -X POST http://localhost:8088/scm/mcp/tools/call/query_bins \
  -H "Content-Type: application/json" \
  -d '{
    "arguments": {
      "tenantId": "20250519_001",
      "warehouseId": 1,
      "status": 1
    }
  }'

# é¢„æœŸå“åº”ï¼šè¿”å›åº“ä½æŸ¥è¯¢ç»“æœï¼ˆJSONæ ¼å¼ï¼‰
```

**æ­¥éª¤3.4ï¼šMCP å®¢æˆ·ç«¯é›†æˆæµ‹è¯•**
```json
// Claude Desktop é…ç½®ç¤ºä¾‹
{
  "mcpServers": {
    "scm-warehouse": {
      "url": "http://localhost:8088/scm/api/mcp/message",
      "transport": "sse"
    }
  }
}
```

**æµ‹è¯•æ£€æŸ¥æ¸…å•**ï¼š
- [ ] å·¥å…·åˆ—è¡¨ç«¯ç‚¹è¿”å›æ­£å¸¸
- [ ] æ‰€æœ‰å·¥å…·éƒ½è¢«æ­£ç¡®æ³¨å†Œ
- [ ] å·¥å…· schema å®Œæ•´ï¼ˆåŒ…å« required å­—æ®µï¼‰
- [ ] å·¥å…·è°ƒç”¨æˆåŠŸè¿”å›ç»“æœ
- [ ] å‚æ•°æ ¡éªŒæ­£å¸¸ï¼ˆå¿…å¡«å‚æ•°ç¼ºå¤±æ—¶æŠ¥é”™ï¼‰
- [ ] Claude Desktop å¯ä»¥å‘ç°å¹¶è°ƒç”¨å·¥å…·

#### é˜¶æ®µ4ï¼šæ–‡æ¡£æ›´æ–°ï¼ˆ0.5hï¼‰

**æ­¥éª¤4.1ï¼šæ›´æ–°å¼€å‘æ–‡æ¡£**
```markdown
# åˆ›å»º MCP å·¥å…·ä½¿ç”¨æ–‡æ¡£
docs/mcp/scm-warehouse-mcp-server.md

å†…å®¹åŒ…æ‹¬ï¼š
- MCP Server ä»‹ç»
- å¯ç”¨å·¥å…·åˆ—è¡¨
- å·¥å…·ä½¿ç”¨ç¤ºä¾‹
- å®¢æˆ·ç«¯é…ç½®æŒ‡å—
```

**æ­¥éª¤4.2ï¼šæ›´æ–° README**
```markdown
# åœ¨é¡¹ç›® README ä¸­æ·»åŠ  MCP ç« èŠ‚
- MCP Server ç«¯ç‚¹
- å·¥å…·æ³¨å†Œæœºåˆ¶
- å¼€å‘æ–°å·¥å…·æŒ‡å—
```

## å…­ã€é£é™©è¯„ä¼°ä¸åº”å¯¹

### 6.1 é£é™©çŸ©é˜µ

| é£é™©ç±»å‹ | é£é™©æè¿° | æ¦‚ç‡ | å½±å“ | åº”å¯¹æªæ–½ |
|---------|---------|------|------|---------|
| **æŠ€æœ¯é£é™©** | MCP Server ä¾èµ–ç‰ˆæœ¬å†²çª | ä½ | ä¸­ | æå‰éªŒè¯ä¾èµ–å…¼å®¹æ€§ |
| **ä¸šåŠ¡é£é™©** | æ”¹é€ åå·¥å…·åŠŸèƒ½å¼‚å¸¸ | ä½ | é«˜ | å®Œæ•´å›å½’æµ‹è¯• |
| **æ€§èƒ½é£é™©** | MCP Server å¢åŠ å“åº”å»¶è¿Ÿ | ä½ | ä¸­ | æ€§èƒ½æµ‹è¯•å¯¹æ¯” |
| **å…¼å®¹é£é™©** | ä¸ç°æœ‰ Function Calling å†²çª | ä¸­ | ä¸­ | éš”ç¦» MCP å’Œ Function Calling |

### 6.2 è¯¦ç»†é£é™©åˆ†æ

#### é£é™©1ï¼šä¾èµ–ç‰ˆæœ¬å†²çª
**æè¿°**ï¼šæ–°å¢ MCP Server ä¾èµ–å¯èƒ½ä¸ç°æœ‰ Spring AI ä¾èµ–å†²çª

**åº”å¯¹æªæ–½**ï¼š
```xml
<!-- æ˜ç¡®æŒ‡å®šç‰ˆæœ¬ -->
<dependency>
    <groupId>org.springframework.ai</groupId>
    <artifactId>spring-ai-starter-mcp-server-webmvc</artifactId>
    <version>${spring-ai.version}</version>
</dependency>

<!-- å¦‚æœå†²çªï¼Œä½¿ç”¨ exclusions -->
<exclusions>
    <exclusion>
        <groupId>org.springframework.ai</groupId>
        <artifactId>spring-ai-core</artifactId>
    </exclusion>
</exclusions>
```

#### é£é™©2ï¼šå·¥å…·åŠŸèƒ½å¼‚å¸¸
**æè¿°**ï¼šæ³¨è§£æ”¹é€ åï¼Œå·¥å…·è°ƒç”¨é€»è¾‘å¯èƒ½å‡ºç°é—®é¢˜

**åº”å¯¹æªæ–½**ï¼š
1. **å•å…ƒæµ‹è¯•**ï¼šä¸ºæ¯ä¸ªå·¥å…·æ–¹æ³•ç¼–å†™å•å…ƒæµ‹è¯•
2. **é›†æˆæµ‹è¯•**ï¼šæµ‹è¯•å·¥å…·è°ƒç”¨çš„å®Œæ•´æµç¨‹
3. **å›å½’æµ‹è¯•**ï¼šç¡®ä¿ç°æœ‰åŠŸèƒ½ä¸å—å½±å“

```java
@SpringBootTest
public class BinMcpToolsTest {

    @Autowired
    private BinMcpTools binMcpTools;

    @Test
    public void testQueryBins() {
        String result = binMcpTools.queryBins(
            "20250519_001",  // tenantId
            1,               // warehouseId
            null,            // locationId
            null,            // code
            1                // status
        );

        assertNotNull(result);
        // éªŒè¯è¿”å›ç»“æœæ ¼å¼
    }
}
```

#### é£é™©3ï¼šæ€§èƒ½å½±å“
**æè¿°**ï¼šMCP Server æ¡†æ¶å¯èƒ½å¢åŠ å“åº”å»¶è¿Ÿ

**åº”å¯¹æªæ–½**ï¼š
1. **æ€§èƒ½åŸºå‡†æµ‹è¯•**ï¼šæ”¹é€ å‰åå¯¹æ¯”æµ‹è¯•
2. **ç›‘æ§æŒ‡æ ‡**ï¼šæ·»åŠ  MCP è°ƒç”¨çš„æ€§èƒ½ç›‘æ§
3. **ä¼˜åŒ–é…ç½®**ï¼šè°ƒæ•´çº¿ç¨‹æ± ã€è¿æ¥æ± å‚æ•°

```yaml
spring:
  ai:
    mcp:
      server:
        # æ€§èƒ½ä¼˜åŒ–é…ç½®
        thread-pool:
          core-size: 10
          max-size: 50
          queue-capacity: 100
```

#### é£é™©4ï¼šå…¼å®¹æ€§é—®é¢˜
**æè¿°**ï¼šMCP å’Œ Function Calling å¯èƒ½åŒæ—¶å­˜åœ¨ï¼Œå¯¼è‡´æ··ä¹±

**åº”å¯¹æªæ–½**ï¼š
1. **æ˜ç¡®åˆ†å·¥**ï¼š
   - MCPï¼šç”¨äº**å¤–éƒ¨å·¥å…·æš´éœ²**ï¼ˆClaude Desktopã€Cursorï¼‰
   - Function Callingï¼šç”¨äº**å†…éƒ¨ AI è°ƒç”¨**ï¼ˆChatClientï¼‰

2. **éš”ç¦»éƒ¨ç½²**ï¼š
   ```java
   // MCP å·¥å…·ï¼ˆå¤–éƒ¨æš´éœ²ï¼‰
   @McpTool(name = "query_bins")
   public String queryBinsForMcp(...) { ... }

   // Function Calling å·¥å…·ï¼ˆå†…éƒ¨ä½¿ç”¨ï¼‰
   @Tool(description = "å†…éƒ¨ä½¿ç”¨çš„åº“ä½æŸ¥è¯¢")
   public String queryBinsInternal(...) { ... }
   ```

### 6.3 å›æ»šè®¡åˆ’

**å¦‚æœæ”¹é€ å¤±è´¥ï¼Œå›æ»šæ­¥éª¤**ï¼š

1. **ä»£ç å›æ»š**ï¼š
   ```bash
   git revert <commit-hash>
   ```

2. **ä¾èµ–å›æ»š**ï¼š
   ```bash
   # ç§»é™¤ MCP Server ä¾èµ–
   vi pom.xml  # åˆ é™¤ spring-ai-starter-mcp-server-webmvc
   mvn clean install
   ```

3. **é…ç½®å›æ»š**ï¼š
   ```bash
   # ç§»é™¤ MCP é…ç½®
   vi application.yml  # åˆ é™¤ spring.ai.mcp é…ç½®
   ```

## ä¸ƒã€æµ‹è¯•ç­–ç•¥

### 7.1 æµ‹è¯•å±‚æ¬¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        é›†æˆæµ‹è¯•ï¼ˆMCP å®¢æˆ·ç«¯ï¼‰           â”‚  Claude Desktop è¿æ¥æµ‹è¯•
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        API æµ‹è¯•ï¼ˆHTTP ç«¯ç‚¹ï¼‰            â”‚  å·¥å…·å‘ç°ã€å·¥å…·è°ƒç”¨ API
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        å•å…ƒæµ‹è¯•ï¼ˆå·¥å…·æ–¹æ³•ï¼‰             â”‚  å·¥å…·é€»è¾‘ã€å‚æ•°æ ¡éªŒ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 æµ‹è¯•ç”¨ä¾‹è®¾è®¡

#### å•å…ƒæµ‹è¯•ç”¨ä¾‹

| ç”¨ä¾‹ç¼–å· | æµ‹è¯•åœºæ™¯ | é¢„æœŸç»“æœ |
|---------|---------|---------|
| **UT-001** | æŸ¥è¯¢åº“ä½ - æ­£å¸¸åœºæ™¯ | è¿”å›åº“ä½åˆ—è¡¨ JSON |
| **UT-002** | æŸ¥è¯¢åº“ä½ - ç¼ºå°‘ç§Ÿæˆ·ID | æŠ›å‡ºå‚æ•°æ ¡éªŒå¼‚å¸¸ |
| **UT-003** | åˆ›å»ºåº“ä½ - æ­£å¸¸åœºæ™¯ | è¿”å›åˆ›å»ºæˆåŠŸä¿¡æ¯ |
| **UT-004** | åˆ›å»ºåº“ä½ - ç¼–ç é‡å¤ | è¿”å›ä¸šåŠ¡å¼‚å¸¸ä¿¡æ¯ |
| **UT-005** | æ›´æ–°åº“ä½ - æ­£å¸¸åœºæ™¯ | è¿”å›æ›´æ–°æˆåŠŸä¿¡æ¯ |

#### API æµ‹è¯•ç”¨ä¾‹

| ç”¨ä¾‹ç¼–å· | æµ‹è¯•åœºæ™¯ | è¯·æ±‚æ–¹æ³• | é¢„æœŸçŠ¶æ€ç  |
|---------|---------|----------|-----------|
| **API-001** | è·å–å·¥å…·åˆ—è¡¨ | GET /mcp/tools/list | 200 |
| **API-002** | è°ƒç”¨ query_bins | POST /mcp/tools/call/query_bins | 200 |
| **API-003** | è°ƒç”¨ä¸å­˜åœ¨çš„å·¥å…· | POST /mcp/tools/call/nonexist | 404 |
| **API-004** | å‚æ•°ç¼ºå¤± | POST /mcp/tools/call/query_bins | 400 |

#### é›†æˆæµ‹è¯•ç”¨ä¾‹

| ç”¨ä¾‹ç¼–å· | æµ‹è¯•åœºæ™¯ | æµ‹è¯•å·¥å…· | é¢„æœŸç»“æœ |
|---------|---------|---------|---------|
| **IT-001** | Claude Desktop å·¥å…·å‘ç° | Claude Desktop | æ˜¾ç¤ºæ‰€æœ‰ä»“åº“å·¥å…· |
| **IT-002** | é€šè¿‡ Claude è°ƒç”¨ query_bins | Claude Desktop | è¿”å›åº“ä½æ•°æ® |
| **IT-003** | é€šè¿‡ Cursor è°ƒç”¨å·¥å…· | Cursor | æ­£å¸¸æ‰§è¡Œå·¥å…· |

### 7.3 æµ‹è¯•æ•°æ®å‡†å¤‡

```sql
-- æµ‹è¯•ç§Ÿæˆ·
INSERT INTO s_tenant (tenant_code, tenant_name)
VALUES ('20250519_001', 'MCPæµ‹è¯•ç§Ÿæˆ·');

-- æµ‹è¯•ä»“åº“
INSERT INTO m_warehouse (warehouse_code, warehouse_name, tenant_id)
VALUES ('WH001', 'MCPæµ‹è¯•ä»“åº“', 1);

-- æµ‹è¯•åº“åŒº
INSERT INTO m_location (location_code, location_name, warehouse_id)
VALUES ('LOC001', 'MCPæµ‹è¯•åº“åŒº', 1);

-- æµ‹è¯•åº“ä½
INSERT INTO m_bin (bin_code, bin_name, location_id, status)
VALUES ('BIN001', 'MCPæµ‹è¯•åº“ä½', 1, 1);
```

### 7.4 æ€§èƒ½æµ‹è¯•

**æµ‹è¯•ç›®æ ‡**ï¼š
- MCP å·¥å…·è°ƒç”¨å“åº”æ—¶é—´ < 500msï¼ˆP95ï¼‰
- å·¥å…·å‘ç°æ¥å£å“åº”æ—¶é—´ < 100ms
- å¹¶å‘ 100 TPS æ— å¼‚å¸¸

**æµ‹è¯•è„šæœ¬**ï¼š
```bash
# ä½¿ç”¨ Apache JMeter æˆ– wrk
wrk -t10 -c100 -d30s http://localhost:8088/scm/mcp/tools/list
```

## å…«ã€åç»­ä¼˜åŒ–å»ºè®®

### 8.1 è¿‘æœŸä¼˜åŒ–ï¼ˆ1-2 å‘¨ï¼‰

1. **å¢åŠ  Resources èƒ½åŠ›**ï¼š
   ```java
   @McpResource(
       name = "bin_manual",
       description = "åº“ä½ç®¡ç†æ“ä½œæ‰‹å†Œ"
   )
   public String getBinManual() {
       // è¿”å›åº“ä½ç®¡ç†æ–‡æ¡£
   }
   ```

2. **å¢åŠ  Prompts èƒ½åŠ›**ï¼š
   ```java
   @McpPrompt(
       name = "analyze_bin_usage",
       description = "åˆ†æåº“ä½ä½¿ç”¨ç‡æç¤ºæ¨¡æ¿"
   )
   public String getAnalysiPrompt() {
       // è¿”å›åˆ†ææç¤ºæ¨¡æ¿
   }
   ```

3. **å·¥å…·åˆ†ç»„**ï¼š
   ```yaml
   spring:
     ai:
       mcp:
         server:
           tool-groups:
             warehouse: ["query_warehouses", "create_warehouse"]
             location: ["query_locations", "create_location"]
             bin: ["query_bins", "create_bin"]
   ```

### 8.2 ä¸­æœŸä¼˜åŒ–ï¼ˆ1-2 æœˆï¼‰

1. **å·¥å…·æƒé™æ§åˆ¶**ï¼š
   ```java
   @McpTool(
       name = "delete_bin",
       requiredRoles = {"ADMIN", "WAREHOUSE_MANAGER"}
   )
   public String deleteBin(...) { ... }
   ```

2. **å·¥å…·è°ƒç”¨å®¡è®¡**ï¼š
   - è®°å½•æ‰€æœ‰å·¥å…·è°ƒç”¨æ—¥å¿—
   - ç»Ÿè®¡å·¥å…·ä½¿ç”¨é¢‘ç‡
   - ç›‘æ§å¼‚å¸¸è°ƒç”¨

3. **å·¥å…·æ€§èƒ½ä¼˜åŒ–**ï¼š
   - å¢åŠ ç¼“å­˜æœºåˆ¶
   - æ‰¹é‡æŸ¥è¯¢ä¼˜åŒ–
   - å¼‚æ­¥å¤„ç†æ”¯æŒ

### 8.3 é•¿æœŸè§„åˆ’ï¼ˆ3-6 æœˆï¼‰

1. **å¤šç§Ÿæˆ· MCP Server**ï¼š
   - æ¯ä¸ªç§Ÿæˆ·ç‹¬ç«‹çš„ MCP Server å®ä¾‹
   - ç§Ÿæˆ·çº§åˆ«çš„å·¥å…·éš”ç¦»

2. **åŠ¨æ€å·¥å…·æ³¨å†Œ**ï¼š
   - æ”¯æŒè¿è¡Œæ—¶æ³¨å†Œæ–°å·¥å…·
   - å·¥å…·çƒ­æ›´æ–°æœºåˆ¶

3. **MCP ç”Ÿæ€é›†æˆ**ï¼š
   - å‘å¸ƒåˆ° MCP å·¥å…·å¸‚åœº
   - é›†æˆæ›´å¤š MCP å®¢æˆ·ç«¯

## ä¹ã€æ€»ç»“

### 9.1 æ”¹é€ ä»·å€¼

| ç»´åº¦ | æ”¹é€ å‰ | æ”¹é€ å | æå‡ |
|------|--------|--------|------|
| **æ ‡å‡†å…¼å®¹** | âŒ ä¸ç¬¦åˆ MCP æ ‡å‡† | âœ… å®Œå…¨ç¬¦åˆ | 100% |
| **å·¥å…·å‘ç°** | âŒ æ— æ ‡å‡†ç«¯ç‚¹ | âœ… æ ‡å‡† MCP ç«¯ç‚¹ | ä»æ— åˆ°æœ‰ |
| **å®¢æˆ·ç«¯æ”¯æŒ** | âŒ ä»… Spring AI | âœ… æ‰€æœ‰ MCP å®¢æˆ·ç«¯ | è·¨å¹³å° |
| **å¯ç»´æŠ¤æ€§** | ğŸŸ¡ æ··ç”¨æ¦‚å¿µ | âœ… æ¸…æ™°è§„èŒƒ | æ˜¾è‘—æå‡ |
| **æ‰©å±•æ€§** | ğŸŸ¡ æœ‰é™ | âœ… æ”¯æŒ MCP ç”Ÿæ€ | é•¿æœŸä»·å€¼ |

### 9.2 å…³é”®æˆæœ

1. âœ… **æ ‡å‡†åŒ–**ï¼šå®Œå…¨ç¬¦åˆ Anthropic MCP æ ‡å‡†
2. âœ… **äº’æ“ä½œæ€§**ï¼šæ”¯æŒæ‰€æœ‰ MCP å®¢æˆ·ç«¯ï¼ˆClaude Desktopã€Cursorã€VS Codeï¼‰
3. âœ… **å¯å‘ç°æ€§**ï¼šæ ‡å‡†åŒ–çš„å·¥å…·å‘ç°æœºåˆ¶
4. âœ… **å¯æ‰©å±•æ€§**ï¼šæ”¯æŒ Toolsã€Resourcesã€Prompts ä¸‰å¤§èƒ½åŠ›
5. âœ… **é•¿æœŸä»·å€¼**ï¼šä¸ AI ç”Ÿæ€ç³»ç»Ÿæ·±åº¦é›†æˆ

### 9.3 æ‰§è¡Œå»ºè®®

**æ¨èæ‰§è¡Œä¼˜å…ˆçº§**ï¼š
1. ğŸ”¥ **ç«‹å³æ‰§è¡Œ**ï¼šä¾èµ–å’Œé…ç½®ï¼ˆé˜¶æ®µ1ï¼‰
2. ğŸ”¥ **é«˜ä¼˜å…ˆçº§**ï¼šä»£ç æ”¹é€ ï¼ˆé˜¶æ®µ2ï¼‰
3. ğŸŸ¡ **ä¸­ä¼˜å…ˆçº§**ï¼šæµ‹è¯•éªŒè¯ï¼ˆé˜¶æ®µ3ï¼‰
4. ğŸŸ¢ **ä½ä¼˜å…ˆçº§**ï¼šæ–‡æ¡£æ›´æ–°ï¼ˆé˜¶æ®µ4ï¼‰

**æ‰§è¡Œæ—¶é—´çª—å£**ï¼š
- å»ºè®®åœ¨**ä½å³°æœŸ**è¿›è¡Œæ”¹é€ ï¼ˆé¿å…å½±å“ä¸šåŠ¡ï¼‰
- æ€»å·¥ä½œé‡çº¦ **4 å°æ—¶**ï¼Œå¯åœ¨åŠå¤©å†…å®Œæˆ
- å»ºè®®**åˆ†æ”¯å¼€å‘**ï¼Œå……åˆ†æµ‹è¯•ååˆå¹¶ä¸»å¹²

## åã€é™„å½•

### 10.1 å‚è€ƒæ–‡æ¡£

1. **Spring AI å®˜æ–¹æ–‡æ¡£**ï¼š
   - MCP Server: https://docs.spring.io/spring-ai/reference/api/mcp/mcp-server.html
   - Function Calling: https://docs.spring.io/spring-ai/reference/api/tool-calling.html

2. **Anthropic MCP æ ‡å‡†**ï¼š
   - MCP Specification: https://modelcontextprotocol.io/
   - MCP SDK: https://github.com/anthropics/mcp

3. **ç°æœ‰è®¾è®¡æ–‡æ¡£**ï¼š
   - `2025-11-04-ä»“åº“ç®¡ç†MCPæœåŠ¡-æ–¹æ¡ˆ.md`

### 10.2 å·¥å…·æ¸…å•

æ”¹é€ æ¶‰åŠçš„æ‰€æœ‰å·¥å…·æ–¹æ³•ï¼š

**BinMcpTools**ï¼ˆé¢„è®¡ 10 ä¸ªå·¥å…·ï¼‰ï¼š
1. `query_bins` - æŸ¥è¯¢åº“ä½
2. `create_bin` - åˆ›å»ºåº“ä½
3. `update_bin` - æ›´æ–°åº“ä½
4. `delete_bin` - åˆ é™¤åº“ä½
5. `enable_bin` - å¯ç”¨åº“ä½
6. `disable_bin` - ç¦ç”¨åº“ä½
7. `get_bin_detail` - è·å–åº“ä½è¯¦æƒ…
8. `batch_create_bins` - æ‰¹é‡åˆ›å»ºåº“ä½
9. `batch_update_bins` - æ‰¹é‡æ›´æ–°åº“ä½
10. `get_bin_statistics` - è·å–åº“ä½ç»Ÿè®¡

**LocationMcpTools**ï¼ˆé¢„è®¡ 8 ä¸ªå·¥å…·ï¼‰ï¼š
1. `query_locations` - æŸ¥è¯¢åº“åŒº
2. `create_location` - åˆ›å»ºåº“åŒº
3. `update_location` - æ›´æ–°åº“åŒº
4. `delete_location` - åˆ é™¤åº“åŒº
5. `enable_location` - å¯ç”¨åº“åŒº
6. `disable_location` - ç¦ç”¨åº“åŒº
7. `get_location_detail` - è·å–åº“åŒºè¯¦æƒ…
8. `get_location_statistics` - è·å–åº“åŒºç»Ÿè®¡

**WarehouseMcpTools**ï¼ˆé¢„è®¡ 8 ä¸ªå·¥å…·ï¼‰ï¼š
1. `query_warehouses` - æŸ¥è¯¢ä»“åº“
2. `create_warehouse` - åˆ›å»ºä»“åº“
3. `update_warehouse` - æ›´æ–°ä»“åº“
4. `delete_warehouse` - åˆ é™¤ä»“åº“
5. `enable_warehouse` - å¯ç”¨ä»“åº“
6. `disable_warehouse` - ç¦ç”¨ä»“åº“
7. `get_warehouse_detail` - è·å–ä»“åº“è¯¦æƒ…
8. `get_warehouse_statistics` - è·å–ä»“åº“ç»Ÿè®¡

**æ€»è®¡**ï¼šçº¦ **26 ä¸ªå·¥å…·æ–¹æ³•**éœ€è¦æ”¹é€ 

### 10.3 å¸¸è§é—®é¢˜ FAQ

**Q1ï¼šæ”¹é€ åä¼šå½±å“ç°æœ‰ Function Calling å—ï¼Ÿ**
Aï¼šä¸ä¼šã€‚MCP å’Œ Function Calling å¯ä»¥å…±å­˜ï¼Œäº’ä¸å½±å“ã€‚

**Q2ï¼šMCP Server ä¼šå¢åŠ å¤šå°‘æ€§èƒ½å¼€é”€ï¼Ÿ**
Aï¼šæ ¹æ® Spring AI å®˜æ–¹æ•°æ®ï¼ŒMCP Server å¢åŠ çš„å“åº”å»¶è¿Ÿ < 50msï¼ˆP95ï¼‰ã€‚

**Q3ï¼šæ˜¯å¦éœ€è¦åœæœºç»´æŠ¤ï¼Ÿ**
Aï¼šä¸éœ€è¦ã€‚å¯ä»¥é€šè¿‡è“ç»¿éƒ¨ç½²æˆ–æ»šåŠ¨æ›´æ–°å®ç°é›¶åœæœºæ”¹é€ ã€‚

**Q4ï¼šClaude Desktop å¦‚ä½•é…ç½®ï¼Ÿ**
Aï¼šåœ¨ Claude Desktop çš„ MCP è®¾ç½®ä¸­æ·»åŠ ï¼š
```json
{
  "mcpServers": {
    "scm-warehouse": {
      "url": "http://localhost:8088/scm/api/mcp/message",
      "transport": "sse"
    }
  }
}
```

**Q5ï¼šæ”¹é€ åå¦‚ä½•éªŒè¯ï¼Ÿ**
Aï¼šè®¿é—® `http://localhost:8088/scm/mcp/tools/list`ï¼Œåº”è¯¥è¿”å›æ‰€æœ‰æ³¨å†Œçš„å·¥å…·åˆ—è¡¨ã€‚

---

**æ–‡æ¡£å®¡æ ¸**ï¼š
- æŠ€æœ¯æ–¹æ¡ˆï¼šâœ… å®Œæ•´
- é£é™©è¯„ä¼°ï¼šâœ… å®Œæ•´
- å®æ–½æ­¥éª¤ï¼šâœ… æ¸…æ™°
- æµ‹è¯•ç­–ç•¥ï¼šâœ… å…¨é¢

**ä¸‹ä¸€æ­¥è¡ŒåŠ¨**ï¼šæŒ‰ç…§å®æ–½æ­¥éª¤æ‰§è¡Œæ”¹é€ ï¼Œä»é˜¶æ®µ1å¼€å§‹ã€‚
